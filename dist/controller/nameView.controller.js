sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/m/MessageBox","sap/ui/core/Fragment"],function(e,t,r,a){"use strict";return e.extend("com.vf01.off.zvf01offline.controller.nameView",{onInit:function(){},sincronizar:function(){var e=this;var t=this.getView().getModel("data");var r="/sap/opu/odata/sap/Z_OD_FIORI_SD_SRV/DocComercial_SHSet";$.ajax({url:r,type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",success:function(e){t.setProperty("/DocComercial",e.d.results);var r=e.d.results;localStorage.setItem("DocComercial",JSON.stringify(r))},error:function(e){var t=that.getModel("objectView");reject(e)}})},_readOdataV2:function(e,t,r,a){var o=this;var s="/"+t;return new Promise(function(t,i){o.getView().getModel(e).read(s,{filters:r,sorters:a,success:function(e,r){t(e)},error:function(e,t,r){i(new Error(e.message))}})})},_posSap:function(e){var t=this;return new Promise(function(r,a){t.getView().getModel("originModel").create("/VF01Set",e,{parameters:{groupId:"batchCreate"},success:function(e,t){r(t)},error:function(e){a(new Error(e.message))}})})},onEnviar:function(){var e=this;var t=[];var a=e.oView.getModel("originModel");var o="originModel";var s="VF01Set";t=JSON.parse(localStorage.getItem("Facturas"));if(!localStorage.getItem("Facturas")){r.error("No hay actividades por enviar",{icon:r.Icon.ERROR,title:"Error"});return}var i=a.getDeferredGroups().push("batchCreate");a.setDeferredGroups(i);a.setUseBatch(true);var n={groupId:"batchCreate"};t.forEach(e=>{a.create("/VF01Set",e,n)});a.submitChanges({success:function(e){localStorage.removeItem("Facturas")},error:function(e){console.log(e)}})},guardar:function(e){var t=[];var a=this;var o=this.getView().byId("vbeln").getValue();var s={RefDoc:o};if(localStorage.getItem("Facturas")!==undefined&&localStorage.getItem("Facturas")){t=JSON.parse(localStorage.getItem("Facturas"))}t.push(s);localStorage.setItem("Facturas",JSON.stringify(t));r.success("Los datos se han guardado..",{icon:r.Icon.success,title:"Proceso Exitoso"})},getVbeln:function(e){var t=this;var r=e.getSource().getValue();this.inputId=e.getSource().getId();var a=localStorage.getItem("DocComercial");var o=JSON.parse(a);var s=new sap.ui.model.json.JSONModel(o);t.getView().setModel(s,"DocumentosComerciales");sap.ui.getCore().setModel(s,"DocumentosComerciales");var i=t.getView().getModel("DocumentosComerciales");if(!this._valueBusVbeln){this._valueBusVbeln=sap.ui.xmlfragment("com.vf01.off.zvf01offline.view.PopVbeln",this);this._valueBusVbeln.setModel(i);this.getView().addDependent(this._valueBusVbeln)}this._valueBusVbeln.open()},busVbeln:function(e){var t=e.getParameter("value");var r=new Filter("Vbeln",sap.ui.model.FilterOperator.Contains,t);e.getSource().getBinding("items").filter([r])},busVbelnClose:function(e){var t=e.getParameter("selectedItem");if(t){var r=this.byId(this.inputId);r.setValue(t.getTitle());var a=this.getView().getModel("data").oData.DocVtasCont;var o=a.filter(e=>e.Vbeln===t.getTitle())}e.getSource().getBinding("items").filter([])},getRouter:function(){return sap.ui.core.UIComponent.getRouterFor(this)}})});